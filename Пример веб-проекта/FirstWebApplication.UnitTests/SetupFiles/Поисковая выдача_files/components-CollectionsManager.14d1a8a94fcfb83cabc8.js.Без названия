/*! For license information please see components-CollectionsManager.14d1a8a94fcfb83cabc8.js.LICENSE.txt */
"use strict";(self["webpackChunkavito_desktop_site"]=self["webpackChunkavito_desktop_site"]||[]).push([[59111],{52932:function(t,n,e){e.d(n,{G6:function(){return r},SY:function(){return c},Z9:function(){return u}});var o=e(74935),r=function(t){return{type:o.Fb.SET_IS_SSR,payload:{isSsr:t}}},u=function(t){return{type:o.Fb.SHOW_CONTAINER,payload:{shouldShowCollectionsContainer:t}}},c=function(t){return{type:o.Fb.SHOW_EDITOR,payload:{shouldShowCollectionsEditor:t}}}},49325:function(t,n,e){e.r(n),e.d(n,{CollectionsManager:function(){return D}});var o=e(24042),r=e.n(o),u=e(84481),c=e.n(u),i=e(28216),l=e(50991),a=e(7343),f=e(27783),s=e(40905),d=e(55085),m=e(81020),C=e(74935),v=function(t){var n=t.text,e=t.onButtonClick;return c().createElement(f.L,{fullWidth:!0,align:"center"},c().createElement(f.L.Slot,{grow:!0},c().createElement(s.D,{dense:!0,size:"m",marker:"".concat(C.jU,"/add-to-collection-text")},n," можно добавить в",C.Xz,"подборку")),c().createElement(d.z,{preset:"defaultInverse",marker:"".concat(C.jU,"/add-to-collection-button"),onClick:e},"Добавить"))},p=function(t){var n=t.text,e=t.collectionId,o=t.onButtonClick;return c().createElement(f.L,{fullWidth:!0},c().createElement(f.L.Slot,{grow:!0,align:"center"},c().createElement(m.P,{dense:!0,size:"m",marker:"".concat(C.jU,"/go-to-collection-text"),maxLines:2},n)),c().createElement(f.L.Slot,{align:"center"},c().createElement(d.z,{preset:"defaultInverse",marker:"".concat(C.jU,"/go-to-collection-button"),onClick:function(){null==o||o(),window.location.assign("/favorites/collections/".concat(e))}},"Перейти")))},E=function(t){var n=t.text;return c().createElement(s.D,{dense:!0,size:"m",marker:"".concat(C.jU,"/custom-notification-text")},n)},h=e(54943),y=e(18266),I=function(){var t=(0,i.useDispatch)();(0,u.useEffect)((function(){return(0,y.vg)((function(n){var e=n.isFavorite,o=n.itemId;o&&t(e?function(t){return function(n,e){n({type:C.Fb.ITEM_REMOVED_FROM_BUFFER,payload:{itemId:t}}),(0,h.m)(e()).itemsIdsBuffer.length?(0,y.yv)():(0,y.J_)()}}(o):function(t){return function(n){n({type:C.Fb.ITEM_ADDED_TO_BUFFER,payload:{itemId:t}}),(0,y.yv)()}}(o))})),function(){(0,y.fG)()}}),[t])},S=e(3982),b=function(t){var n,e=t.itemsCount,o=t.onButtonClick,r=t.Content;return n=1===e?"Объявление":"".concat(e," ").concat(S.Z.plural(e,C.mL)),c().createElement(r,{text:n,onButtonClick:o})},g=function(t){var n=t.collectionId,e=t.createOnly,o=t.onButtonClick,r=t.Content;return c().createElement(r,{collectionId:n,text:e?"Подборка создана":"Добавлено в".concat(C.Xz,"подборку"),onButtonClick:o})},k=function(t){var n=t.text,e=t.Content;return c().createElement(e,{text:n})};function w(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return A(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return A(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}var B=function(t){var n=t.eid,e=t.version,o=void 0===e?1:e,r=t.itemIds,u=t.collectionId,c={iids:w(r)};u&&(c.favlist=u),document.dispatchEvent(new CustomEvent("clickstream.event",{detail:{eid:n,version:o,params:c}}))};function F(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var o,r,u=[],c=!0,i=!1;try{for(e=e.call(t);!(c=(o=e.next()).done)&&(u.push(o.value),!n||u.length!==n);c=!0);}catch(l){i=!0,r=l}finally{try{c||null==e["return"]||e["return"]()}finally{if(i)throw r}}return u}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return _(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}var T=function(t){var n;null===(n=t.current)||void 0===n||n.clean(),t.current=null},x=function(t){var n;null===(n=t.current)||void 0===n||n.hide(),t.current=null},j=function(t){var n=t.itemsIdsBuffer,e=t.clearItemsInBuffer,o=t.onShowCollectionsContainerClick,r=t.components,i=F((0,u.useState)(!1),2),l=i[0],a=i[1],f=F((0,u.useState)(!1),2),s=f[0],d=f[1],m=F((0,u.useState)(null),2),C=m[0],v=m[1],p=F((0,u.useState)(null),2),E=p[0],h=p[1],I=F((0,u.useState)(null),2),S=I[0],w=I[1],A=F((0,u.useState)(null),2),_=A[0],j=A[1],O=(0,u.useRef)(null),R=(0,u.useRef)(null),D=(0,u.useRef)(null);(0,u.useEffect)((function(){j(window.location.pathname)}),[]),(0,u.useEffect)((function(){return(0,y.DT)((function(){a(!0)})),(0,y.We)((function(){d(!0)})),(0,y.aM)((function(t){v(t)})),(0,y.Pg)((function(t){return h(t)})),(0,y.Bq)((function(t){return w(t)})),function(){(0,y.iP)(),T(D),x(O)}}),[]),(0,u.useEffect)((function(){(s||C||E||S)&&(R.current=_)}),[s,C,E,S,_]),(0,u.useEffect)((function(){l&&(x(O),a(!1))}),[l,a]);var U=r.Toast,M=r.SuggestAddToCollectionContent,z=r.AddedToCollectionContent,L=r.CustomNotificationContent;(0,u.useEffect)((function(){var t;s&&n.length&&(T(D),D.current=(0,y.FJ)((function(){T(D),e()})),O.current=U.show(c().createElement(b,{itemsCount:n.length,Content:M,onButtonClick:function(){var t;o(!0),t={itemIds:n}.itemIds,B({eid:7190,itemIds:t}),T(D),x(O)}}),y.Ps),null===(t=D.current)||void 0===t||t.call(D),d(!1))}),[s,n,d,e,o,U,M]),(0,u.useEffect)((function(){if(C){var t=C.collectionId,n=C.itemsIds;O.current=U.show(c().createElement(g,{collectionId:t,createOnly:!(null!=n&&n.length),Content:z,onButtonClick:function(){!function(t){var n=t.itemIds,e=t.collectionId;B({eid:7191,itemIds:n,collectionId:e})}({itemIds:n||[],collectionId:t})}}),y.Ps),v(null)}}),[C,v,U,z]),(0,u.useEffect)((function(){E&&(O.current=U.show(c().createElement(k,{text:E,Content:L}),y.eQ),h(null))}),[E,h,U,L]),(0,u.useEffect)((function(){S&&(O.current=U.show(c().createElement(k,{text:S,Content:L}),y.Ps),w(null))}),[S,w,U,L]),(0,u.useEffect)((function(){var t;null!==(t=O.current)&&void 0!==t&&t.hide&&R.current&&R.current!==_&&(R.current=null,x(O),T(D),e())}),[_,e])},O=e(52932),R=c().lazy((function(){return e.e(16556).then(e.bind(e,96352)).then((function(t){return{default:t.Popup}})).then((function(t){return{default:r()(t.default,"Popup")}}))})),D=function(t){var n=t.updateWithBufferedItems,e=t.renderNotificationContainer,o=(0,i.useSelector)(h.m),r=o.itemsIdsBuffer,f=o.shouldShowCollectionsContainer,s=(0,i.useDispatch)(),d=(0,u.useCallback)((function(){return s({type:C.Fb.ITEMS_BUFFER_CLEARED})}),[s]),m=(0,u.useCallback)((function(t){return s((0,O.Z9)(t))}),[s]);return I(),j({itemsIdsBuffer:r,clearItemsInBuffer:d,onShowCollectionsContainerClick:m,components:{Toast:l.F,SuggestAddToCollectionContent:v,AddedToCollectionContent:p,CustomNotificationContent:E}}),c().createElement(c().Fragment,null,e&&c().createElement(a.NotificationContainer,{place:"bottom",position:"fixed",marker:"".concat(C.jU,"/notification-container")}),f&&c().createElement(R,{updateWithBufferedItems:n}))}},54943:function(t,n,e){e.d(n,{j:function(){return u},m:function(){return r}});var o=e(74935),r=function(t){return t[o.IJ]},u=function(t){return r(t).shouldShowCollectionsContainer}}}]);