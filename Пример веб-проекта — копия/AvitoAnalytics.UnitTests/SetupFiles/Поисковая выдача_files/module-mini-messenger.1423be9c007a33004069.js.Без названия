/*! For license information please see module-mini-messenger.1423be9c007a33004069.js.LICENSE.txt */
"use strict";(self["webpackChunkavito_desktop_site"]=self["webpackChunkavito_desktop_site"]||[]).push([[36481],{56814:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var r=n(84481),o=n.n(r),a=n(76535),l="index-wrapper-vy8Nq",u=function(){return o().createElement("div",{className:l},o().createElement(a.h,null))}},66955:function(e,t,n){n.d(t,{X:function(){return r}});var r=function(e){return"catalog"===e?window.location.search.includes("map=")?"map":"serp":e||""}},40328:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var r=n(84481),o=n.n(r),a=n(94184),l=n.n(a),u=n(83203),i=n(61741),c=n(61928),s=n(55085),f=n(80814),p=n(66955),m="index-target-QWE1c",d="index-target_hasPush-_oHfM";function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(i){u=!0,o=i}finally{try{l||null==n["return"]||n["return"]()}finally{if(u)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=3e3,b={offset:[0,16]},g={offset:[0,114]},w="mini-messenger/realty-promo-tooltip",S=function(e){var t=(0,u.i)(),n=(0,r.useRef)(!1),a=h((0,r.useState)(!1),2),v=a[0],S=a[1],E=e.itemId,I=e.locationSlug,C=e.needToShow,P=e.page,k=e.tooltipInfo,A=void 0===k?{}:k,O=A.buttonTitle,x=A.text,j=A.url,T=(0,r.useCallback)((function(e){t&&!n.current&&(n.current=!0,t.post("/web/1/developmentsChatBot/closeTooltip",{closeType:e,fromPage:(0,p.X)(P),itemId:E,locationSlug:I},{id:"/web/1/developmentsChatBot/closeTooltip"}))}),[t,E,P,I]),L=h((0,r.useState)(!1),2),H=L[0],M=L[1],N=(0,r.useCallback)((function(){j&&(T("button"),window.location.pathname=j)}),[T,j]);(0,r.useEffect)((function(){M(C)}),[C]),(0,f.O)("app-messenger.realty.promo-tooltip.close",(function(){C&&(M(!1),T("messenger"))})),(0,f.O)("app-messenger.realty.promo-tooltip.messenger-has-push",(function(e){S(e.detail.hasPush)}));var U,R,_,z=(0,r.useCallback)((function(){M(!1),T("cross")}),[T,M]);return o().createElement(i.f,null,o().createElement(c.u,{marker:w,content:x,delayIn:y,actions:o().createElement(s.z,{preset:"defaultInverse",onClick:N},O),maxWidth:210,placement:"top",open:H,closable:!0,animationName:void 0,offset:v?g:b,onClose:z},o().createElement("span",{className:l()(m,(U={},R=d,_=v,R in U?Object.defineProperty(U,R,{value:_,enumerable:!0,configurable:!0,writable:!0}):U[R]=_,U))})))}},81358:function(e,t,n){n.d(t,{Z:function(){return H}});var r=n(24042),o=n.n(r),a=n(84481),l=n(29363),u=n(99322),i=n(5035),c=n(63123),s=n(64167),f=n(28910),p=n(11845),m=n(83203),d=n(66955);function h(e,t,n,r,o,a,l){try{var u=e[a](l),i=u.value}catch(c){return void n(c)}u.done?t(i):Promise.resolve(i).then(r,o)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function l(e){h(a,r,o,l,u,"next",e)}function u(e){h(a,r,o,l,u,"throw",e)}l(void 0)}))}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(i){u=!0,o=i}finally{try{l||null==n["return"]||n["return"]()}finally{if(u)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g={needToShow:!1},w=function(e){var t=e.enabled,n=e.fromPage,r=e.itemId,o=e.locationSlug,l=(0,m.i)(),u=(0,s.a)(),i=y((0,a.useState)(g),2),c=i[0],f=i[1],p=(0,a.useCallback)(v(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(l&&u){e.next=2;break}return e.abrupt("return",g);case 2:return e.prev=2,e.next=5,l.post("/web/1/developmentsChatBot/getTooltip",{fromPage:(0,d.X)(n),itemId:r,locationSlug:o},{id:"/web/1/developmentsChatBot/getTooltip"});case 5:return t=e.sent,a=t.data,e.abrupt("return",(null==a?void 0:a.result)||g);case 10:e.prev=10,e.t0=e["catch"](2);case 12:return e.abrupt("return",g);case 13:case"end":return e.stop()}}),e,null,[[2,10]])}))),[l,u,n,r,o]);return(0,a.useEffect)((function(){t&&p().then((function(e){f(e)}))}),[t,p]),t?c:void 0},S=n(69850),E=n(58598),I="index-layout-WcVLz",C=["itemId","locationSlug","realtyPromoTooltipData","page"];function P(){return P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},P.apply(this,arguments)}function k(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(i){u=!0,o=i}finally{try{l||null==n["return"]||n["return"]()}finally{if(u)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=a.lazy((function(){return Promise.all([n.e(16982),n.e(36481),n.e(85559)]).then(n.bind(n,40328)).then((function(e){return{default:o()(e.default,"components-RealtyPromoTooltip")}}))})),j=a.lazy((function(){return Promise.all([n.e(36481),n.e(52268)]).then(n.bind(n,56814)).then((function(e){return{default:o()(e.default,"components-CallNotification")}}))})),T={bottom:32,right:10},L=function(e){var t=e.itemId,n=e.locationSlug,r=e.realtyPromoTooltipData,o=e.page,l=k(e,C),u={isHashRotateEnabled:l.isHashRotateEnabled,isHostLocalhost:l.isHostLocalhost,abCentral:l.abCentral,hostAppName:l.hostAppName,userIdHash:l.userIdHash,externalLocation:l.externalLocation,avitoUrl:l.avitoUrl},i=a.createElement(E.i,u);return r?a.createElement("div",null,a.createElement(a.Suspense,{fallback:null},a.createElement(x,P({itemId:t,locationSlug:n,page:o},r))),i):i},H=(0,i.Z)((function(){return(0,c.Z)((function(e){var t=e.page,n=e.match;return function(e){var r,o,u=e.withRealtyPromoTooltip,i=e.page,c=(0,l.x)(),f=(0,s.a)(),m=(0,S.useLocation)(),d=null==n||null===(r=n.params)||void 0===r?void 0:r.itemId,h=d?Number(d):void 0,v=null==n||null===(o=n.params)||void 0===o?void 0:o.location,y=w({enabled:u,fromPage:i,itemId:h,locationSlug:v}),b=function(){var e=A(a.useState(!1),2),t=e[0],n=e[1],r=a.useCallback((function(e){switch(e.type){case"geo-search:fullMapLoad":n(!0);break;case"geo-search:fullMapUnload":n(!1)}}),[]);return a.useEffect((function(){return document.addEventListener("geo-search:fullMapLoad",r),document.addEventListener("geo-search:fullMapUnload",r),function(){document.removeEventListener("geo-search:fullMapLoad",r),document.removeEventListener("geo-search:fullMapUnload",r)}}),[r]),t}(),g=A(a.useState(!1),2),E=g[0],C=g[1];if(a.useEffect((function(){C(!0)}),[]),!E||!f)return null;var P=b?T:void 0;return a.createElement(p.Z,{isMiniMessenger:!0,abCentral:c,user:f,currentPage:t.id},(function(e){return a.createElement("div",{className:I,style:P,"data-marker":"mini-messenger"},a.createElement(a.Suspense,{fallback:null},a.createElement(j,null)),a.createElement(L,{hostAppName:"desktop",isHostLocalhost:"production"=="development",isHashRotateEnabled:e.isHashRotateEnabled,userIdHash:e.userIdHash,fromPage:e.fromPage,avitoUrl:e.avitoUrl,abCentral:e.abCentral,externalLocation:m,itemId:h,locationSlug:v,page:i,realtyPromoTooltipData:y}))}))}}))}),[u.O,f.H])}}]);